import { severityToClass, slugifyCveId } from '../utils'

/** @param {{vulnerability: Vulnerability}} param */
export const VulnerabilityTableRow = ({ vulnerability }) => (
  <tr id={`row${slugifyCveId(vulnerability.id)}`}>
    <td>
      <table>
        <tbody>
          <tr>
            <td className='details'><label>ID</label></td>
            <td className='details'>
              <a href={`#row${slugifyCveId(vulnerability.id)}`}>
                {vulnerability.id}
              </a>
            </td>
          </tr>
          <tr>
            <td className='details'><label>Компонент</label></td>
            <td className='details'>{vulnerability.package}</td>
          </tr>
          <tr>
            <td className='details'><label>Текущая версия</label></td>
            <td className='details'>{vulnerability.version}</td>
          </tr>
          <tr>
            <td className='details'><label>Версия исправления</label></td>
            <td className='details'>{vulnerability.fix_version}</td>
          </tr>
          <tr>
            <td className='details'><label>Уровень</label></td>
            <td className='details'>
              <span className={severityToClass(vulnerability.severity)}>
                {vulnerability.severity}
              </span>
            </td>
          </tr>
          <tr>
            <td className='details'><label>Описание</label></td>
            <td className='details' style={{whiteSpace: 'normal'}}>{vulnerability.description}</td>
          </tr>
        </tbody>
      </table>
    </td>
  </tr>
)
